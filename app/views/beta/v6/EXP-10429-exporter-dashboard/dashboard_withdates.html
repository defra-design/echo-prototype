{% extends "layout.html" %}
{% block pageTitle %}
GOV.UK Prototype Kit
{% endblock %}
{% block beforeContent %}
<div class="login-nav login-border">
  <ul class="login-nav__list">
    <li class="login-nav__list-item" id="Nav-DisplayName">Ann Cooper</li>
    <li class="login-nav__list-item"> | <a href="https://identity-management-app.herokuapp.com/manage/team-members/services-on-team-member-admin-account_company-exports?serviceLine=Exporter%20Service&serviceRole=Exporter&numUsers=1&numAgents=0&numServices=1&multiOrg=no&parentChild=parent"
        class="govuk-link login-nav__link govuk-link--no-visited-state profile" id="Link-ManageAccount">Manage account</a>|</li>
    <li class="login-nav__list-item"><a href="#ß" class="govuk-link login-nav__link govuk-link--no-visited-state" id="Link-SignOut">Sign out</a></li>
  </ul>
</div>
{% endblock%}
{% block content %}
<style>
  main{padding-top: 0px!important;}
    .green-tag{background: #00823b}
</style>

<style>
  #filter-cert-org #filter-container {
        bottom: 0px;
        color: rgb(255, 255, 255);
        height: 40px;
        left: 0px;
        position: relative;
        right: 0px;
        text-decoration: none solid rgb(255, 255, 255);
        text-size-adjust: 100%;
        top: 0px;
        width: 300px;
        column-rule-color: rgb(255, 255, 255);
        perspective-origin: 150px 20px;
        transform-origin: 150px 20px;
        caret-color: rgb(255, 255, 255);
        background: rgb(0, 94, 165) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 36 36' width='40' height='40'%3E%3Cpath d='M25.7 24.8L21.9 21c.7-1 1.1-2.2 1.1-3.5 0-3.6-2.9-6.5-6.5-6.5S10 13.9 10 17.5s2.9 6.5 6.5 6.5c1.6 0 3-.6 4.1-1.5l3.7 3.7 1.4-1.4zM12 17.5c0-2.5 2-4.5 4.5-4.5s4.5 2 4.5 4.5-2 4.5-4.5 4.5-4.5-2-4.5-4.5z' fill='white'%3E%3C/path%3E%3C/svg%3E") no-repeat scroll 0% 0% / 40px 40px padding-box border-box;
        border: 0px none rgb(255, 255, 255);
        font: normal normal 400 normal 16px / normal "Times New Roman";
        outline: rgb(255, 255, 255) none 0px;
    }/*#filter-container*/
    #filter-cert-org #filter-container:after {
        color: rgb(255, 255, 255);
        text-decoration: none solid rgb(255, 255, 255);
        text-size-adjust: 100%;
        column-rule-color: rgb(255, 255, 255);
        caret-color: rgb(255, 255, 255);
        border: 0px none rgb(255, 255, 255);
        font: normal normal 400 normal 16px / normal "Times New Roman";
        outline: rgb(255, 255, 255) none 0px;
    }/*#DIV_4:after*/
    #filter-cert-org #filter-container:before {
        color: rgb(255, 255, 255);
        text-decoration: none solid rgb(255, 255, 255);
        text-size-adjust: 100%;
        column-rule-color: rgb(255, 255, 255);
        caret-color: rgb(255, 255, 255);
        border: 0px none rgb(255, 255, 255);
        font: normal normal 400 normal 16px / normal "Times New Roman";
        outline: rgb(255, 255, 255) none 0px;
    }/*#DIV_4:before*/
    #filter-cert-org #filter-input {
        bottom: 0px;
        height: 22px;
        left: 0px;
        position: relative;
        right: 0px;
        text-size-adjust: 100%;
        top: 0px;
        width: 260px;
        perspective-origin: 130px 20px;
        transform-origin: 130px 20px;
        border: 2px solid rgb(255, 255, 255);
        font: normal normal 400 normal 19px / 25px nta, Arial, sans-serif;
        margin: 0px 0px 0px 40px;
        padding: 9px 10px 5px;
        border: solid 2px #000;
        outline: none;
    }/*#filter-input*/
    #filter-cert-org #filter-input:focus {
        border: solid 2px #ffbf47;
        outline: none;
    }/*#filter-input*/
    #filter-cert-org #filter-input:after {
        text-size-adjust: 100%;
        font: normal normal 400 normal 19px / 25px nta, Arial, sans-serif;
    }/*#filter-input:after*/
    #filter-cert-org #filter-input:before {
        text-size-adjust: 100%;
        font: normal normal 400 normal 19px / 25px nta, Arial, sans-serif;
    }/*#filter-input:before*/
    .govuk-details__summary:before{display: none}
</style>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl">Your applications</h1>
    <a class="govuk-button" href="select-certificate">Start a new application</a>
  </div>
</div>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <form method="GET">
      <div class="search-wrapper govuk-form-group">
        <label for="search-reservations" class="govuk-label">
          Search by certificate ID, application ID, destination or reference number
        </label>
        <div class="search-input-wrapper">
          <input type="search" value="{{query.search or ''}}" id="search-reservations" name="search" title="Search" class="govuk-input">
          <div class="search-input-submit-wrapper">
            <button type="submit" class="search-submit">Search</button>
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="govuk-grid-column-one-third">
    <div class="defra-filter--action" style="display:none">
      <button id="defra-filter--button" class="govuk-button govuk-button--secondary govuk-!-margin-top-6 {% if data.has_filter == 'yes'%}defra-filter-button--active{% endif%}" type="button" aria-expanded="false"><span class="defra-filter--button-content">Show
          filters</span>
        {% if data.has_filter %}({{(data.filter_status | length) or '1'}}){% endif %}<span class="defra-filter__icon"></span></button>
    </div>
  </div>
</div>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <div class="derfa-filter--content">
      <form method="get">
        <div class="govuk-grid-row">
          <div class="govuk-grid-column-one-third">
            <div class="govuk-form-group">
              <fieldset class="govuk-fieldset">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                  Filter by status
                </legend>
                <div class="govuk-checkboxes govuk-checkboxes--small ">
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="type-9" name="filter_status" type="checkbox" value="draft" {% if data.filter_status and data.filter_status !='_unchecked'  and 'draft' in data.filter_status %}checked="checked" {% endif%}>
                    <label class="govuk-label govuk-checkboxes__label" for="type-9">
                      Draft
                    </label>
                  </div>
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="type-3" name="filter_status" type="checkbox" value="processing" {% if data.filter_status and data.filter_status !='_unchecked' and 'processing' in data.filter_status %}checked="checked"
                      {% endif %}>
                    <label class="govuk-label govuk-checkboxes__label" for="type-3">
                      Processing
                    </label>
                  </div>
                  <div class="govuk-checkboxes__item ">
                    <input class="govuk-checkboxes__input" id="type" name="filter_status" type="checkbox" value="dispatched" {% if data.filter_status and data.filter_status !='_unchecked' and 'dispatched' in data.filter_status %}checked="checked" {%
                      endif %}>
                    <label class="govuk-label govuk-checkboxes__label" for="type">
                      Dispatched
                    </label>
                  </div>
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="type-2" name="filter_status" type="checkbox" value="certifier action" {% if data.filter_status and data.filter_status !='_unchecked' and 'certifier action' in data.filter_status
                      %}checked="checked" {% endif %}>
                    <label class="govuk-label govuk-checkboxes__label" for="type-2">
                      Certifier action
                    </label>
                  </div>


                </div>
                <div class="govuk-checkboxes govuk-checkboxes--small ">
                  <div class="  govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="type-8" name="filter_status" type="checkbox" value="completed" {% if data.filter_status and data.filter_status !='_unchecked' and 'completed' in data.filter_status %}checked="checked" {%
                      endif %}>
                    <label class="govuk-label govuk-checkboxes__label" for="type-8">
                      Completed
                    </label>
                  </div>
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="type-4" name="filter_status" type="checkbox" value="cancelled" {% if data.filter_status and data.filter_status !='_unchecked' and 'cancelled' in data.filter_status %}checked="checked" {%
                      endif %}>
                    <label class="govuk-label govuk-checkboxes__label" for="type-4">
                      Cancelled
                    </label>
                  </div>

                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="type-6" name="filter_status" type="checkbox" value="rejected" {% if data.filter_status and data.filter_status !='_unchecked' and 'rejected' in data.filter_status %}checked="checked" {%
                      endif %}>
                    <label class="govuk-label govuk-checkboxes__label" for="type-6">
                      Rejected
                    </label>
                  </div>





                </div>
              </fieldset>
            </div>
          </div>
          <div class="govuk-grid-column-two-thirds ">

            <div class="govuk-form-group">
              <fieldset class="govuk-fieldset">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                  <span class="govuk-visually-hidden">Filter by</span> Export date
                </legend>
                <div class="govuk-radios govuk-radios--small govuk-radios--conditional" data-module="govuk-radios">
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="date_range" name="date_range" type="radio" value="any" {%if (data.date_range and data.date_range == "any" ) or not data.date_range  %}checked="checked" {%endif%}>
                    <label class="govuk-label govuk-radios__label" for="date_range">
                      Any
                    </label>
                  </div>
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="date_range-1" name="date_range" type="radio" value="today" {%if data.date_range and data.date_range == "today" %}checked="checked" {%endif%}>
                    <label class="govuk-label govuk-radios__label" for="date_range-1">
                      Today
                    </label>
                  </div>
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="date_range-3" name="date_range" type="radio" value="tomorrow" {%if data.date_range and data.date_range == "tomorrow" %}checked="checked" {%endif%}>
                    <label class="govuk-label govuk-radios__label" for="date_range-3">
                      Tomorrow
                    </label>
                  </div>
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="date_range-2" name="date_range" type="radio" value="in next 7 days" {%if data.date_range and data.date_range == "in next 7 days" %}checked="checked" {%endif%}>
                    <label class="govuk-label govuk-radios__label" for="date_range-2">
                      Next 7 days
                    </label>
                  </div>

                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="date_range-4" name="date_range" type="radio" value="custom" {%if data.date_range and  data.date_range  == "custom" %}checked="checked" {%endif%} data-aria-controls="conditional-how-contacted-conditional-2">
                    <label class="govuk-label govuk-radios__label" for="date_range-4">
                      Custom date range
                    </label>
                  </div>
                  <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-how-contacted-conditional-2">
                    <div class="govuk-grid-row">
                      <div class="govuk-grid-column-one-half ">
                        <div class="govuk-form-group">
                          <fieldset class="govuk-fieldset" role="group" aria-describedby="passport-issued-hint">
                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                              <h1 class="govuk-fieldset__heading">
                                From
                              </h1>
                            </legend>
                            <span id="passport-issued-hint" class="govuk-hint">
                            </span>
                            <div class="govuk-date-input" id="passport-issued">
                              <div class="govuk-date-input__item">
                                <div class="govuk-form-group">
                                  <label class="govuk-label govuk-date-input__label" for="export_form_day">
                                    Day
                                  </label>
                                  <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="export_form_day" name="export_form_day" type="text" pattern="[0-9]*" inputmode="numeric">
                                </div>
                              </div>
                              <div class="govuk-date-input__item">
                                <div class="govuk-form-group">
                                  <label class="govuk-label govuk-date-input__label" for="export_form_month">
                                    Month
                                  </label>
                                  <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="export_form_month" name="export_form_month" type="text" pattern="[0-9]*" inputmode="numeric">
                                </div>
                              </div>
                              <div class="govuk-date-input__item">
                                <div class="govuk-form-group">
                                  <label class="govuk-label govuk-date-input__label" for="passport-issued-year">
                                    Year
                                  </label>
                                  <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="export_form_year" name="export_form_year" type="text" pattern="[0-9]*" inputmode="numeric">
                                </div>
                              </div>
                            </div>
                          </fieldset>
                        </div>
                      </div>
                      <div class="govuk-grid-column-one-half ">
                        <div class="govuk-form-group">
                          <fieldset class="govuk-fieldset" role="group" aria-describedby="passport-issued-hint">
                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                              <h1 class="govuk-fieldset__heading">
                                to
                              </h1>
                            </legend>
                            <span id="passport-issued-hint" class="govuk-hint">
                            </span>
                            <div class="govuk-date-input" id="passport-issued">
                              <div class="govuk-date-input__item">
                                <div class="govuk-form-group">
                                  <label class="govuk-label govuk-date-input__label" for="export_to_day">
                                    Day
                                  </label>
                                  <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="export_to_day" name="export_to_day" type="text" pattern="[0-9]*" inputmode="numeric">
                                </div>
                              </div>
                              <div class="govuk-date-input__item">
                                <div class="govuk-form-group">
                                  <label class="govuk-label govuk-date-input__label" for="export_to_month">
                                    Month
                                  </label>
                                  <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="export_to_month" name="export_to_month" type="text" pattern="[0-9]*" inputmode="numeric">
                                </div>
                              </div>
                              <div class="govuk-date-input__item">
                                <div class="govuk-form-group">
                                  <label class="govuk-label govuk-date-input__label" for="export_to_year">
                                    Year
                                  </label>
                                  <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="export_to_year" name="export_to_year" type="text" pattern="[0-9]*" inputmode="numeric">
                                </div>
                              </div>
                            </div>
                          </fieldset>
                        </div>
                      </div>
                    </div>

                  </div>
                </div>


              </fieldset>



            </div>

            <!-- <div class="govuk-form-group">
              <div class="form-date">
        <div class="sm-daterange-component">

          <label for="from" class="sm-daterange-label  govuk-label from">From</label>
          <div class="sm-daterange-input-wrapper from">
            <input type="text" id="from" name="from" placeholder="DD/MM/YYYY" class="govuk-input sm-daterange-input from" autocomplete="off">
            <span class="sm-calendar-icon">
              <i class="far fa-calendar-alt"><span class="visually-hidden">From date range</span></i>
            </span>
          </div>

          <label for="to" class="sm-daterange-label govuk-label to">to</label>
          <div class="sm-daterange-input-wrapper to">
            <input type="text" id="to" name="to" placeholder="DD/MM/YYYY" class="govuk-input sm-daterange-input to" autocomplete="off">
            <span class="sm-calendar-icon">
              <i class="far fa-calendar-alt"><span class="visually-hidden">To date range</span></i>
            </span>
          </div>

        </div>
      </div>
            </div> -->
          </div>

          <div class="govuk-grid-column-full">
            <button type="submit" class="govuk-button govuk-!-margin-bottom-0" data-module="govuk-button" name="has_filter" value="yes">
              Apply filter
            </button>
            {% if data.has_filter %}
            <a href="dashboard?filter_status=&has_filter=" class="defra-link-button defra-link-button--inline" data-module="govuk-button">
              Clear filters
            </a>
            {% endif %}
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="govuk-grid-column-full">
    {% if data.has_filter == "yes" or query.search %}
    <div class="filter-tag--wrapper govuk-!-margin-bottom-6" data-module="track-click">
      <p class="govuk-body govuk-!-margin-bottom-2">
        Showing <span id="js-case-count"></span> applications {% if query.search %} matching <strong>‘{{query.search}}’</strong>{% endif %}
        {% if data.has_filter == "yes"%}
        with status {% for filter in data.filter_status %}
        <strong>{{filter | capitalize}}</strong>{%if (data.filter_status|length)-1 == (loop.index) and (data.filter_status|length) != 1 %} or {% elseif (data.filter_status|length) != (loop.index)%},{%endif%}
        {%endfor%}
        {% endif %}
        {% if data.date_range and data.date_range != "any"%} exporting {% if data.date_range == "custom" %}from <strong>2 Jan 2020 </strong> to <strong>30th Jan 2020 </strong> {% else %}<strong>{{data.date_range}}</strong>{% endif %}{% endif %}
      </p>
      <p class="govuk-body">
        <a href="dashboard?filter_status=&has_filter=" class="govuk-link govuk-link--no-visited-state govuk-!-font-size-19" data-module="govuk-button">
          Clear
          {% if data.filter_status and query.search %}
          search and filter
          {% elseif data.filter_status %}
          filter
          {% else %}
          search
          {% endif %}
        </a>
      </p>
      <!-- {% for filter in data.filter_status %}
        <div class="filter-tag">
          <p class="filter-tag--text">{{filter | capitalize}}</p> <button type="button" class="filter-tag--remove" aria-label="Remove filter australia" data-module="remove-filter-link" data-track-label="australia" data-facet="keywords" data-value="australia"
            data-name="keywords">✕</button>
        </div>
        {% endfor %} -->

    </div>
    {% endif %}

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full">
        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th class="govuk-table__header">
                <div class="applicationRef-column">Application</div>
              </th>
              <th class="govuk-table__header">Reference</th>
              <th class="govuk-table__header">Destination</th>
              <th class="govuk-table__header">Submitted date</th>
              <th class="govuk-table__header">Status</th>
            </tr>
          </thead>
          <tbody>

            {% for app in data.applications %}

            {%
            if (not query.search and data.has_filter != "yes")
            or (query.search and (query.search) == (app.applicationID))
            or (query.search and (query.search) == (app.destination))
            or (query.search and (query.search) == (app.reference))
            or (query.search and (query.search) == (app.certificate))
            or app.status in data.filter_status
            %}
            <tr class="govuk-table__row result">
              <th id="1721147986456-appRef" class="b govuk-table__cell applicationRef-column" scope="row">
                <a href="application?reference_num=AUS03402342-KXC&application_id=100065956486&application_status=completed&is_pending_replacement=yes" class="govuk-link govuk-link--no-visited-state">{{app.applicationID}}</a>
              </th>
              <td id="1721147986456-group-number" class="govuk-table__cell" scope="row">
                {{app.reference}}
              </td>
              <td id="1721147986456-submitted" class="govuk-table__cell submitted-column" scope="row">
                {{app.destination}}
              </td>
              <td id="1721147986456-submitted" class="govuk-table__cell submitted-column" scope="row">
                {{app.date}}
              </td>
              <td id="1721147986456-status" class="govuk-table__cell" scope="row">
                <div class="status-tag status-tag--{{app.status | lower}}">
                  {{app.status}}
                </div>
              </td>
            </tr>
            {% endif %}
            {% endfor %}

          </tbody>
        </table>
        <div class="app-example-page">
          <nav class="defra-pagination" id="pagination-label">
            <p class="govuk-visually-hidden" aria-labelledby="pagination-label">Pagination navigation</p>
            <ul class="defra-pagination__list">
              <li class="defra-pagination__item  defra-pagination__item--prev">
                <a class="defra-pagination__link" href="">Previous<span class="govuk-visually-hidden"> set of pages</span></a>
              </li>
              <li class="defra-pagination__item defra-pagination__item--active"><a class="defra-pagination__link" href="#" style="color: black!important;font-weight: 700">1</a></li>
              <li class="defra-pagination__item"><a class="defra-pagination__link" href="#">2</a></li>
              <li class="defra-pagination__item"><a class="defra-pagination__link" href="#">3</a></li>
              <li class="defra-pagination__item  defra-pagination__item--next">
                <a class="defra-pagination__link" href="">Next<span class="govuk-visually-hidden"> set of pages</span></a>
              </li>
            </ul>
            <p class="defra-pagination__results">Showing <b>1</b> to <b>30</b> of <b>90</b> results</p>
          </nav>
        </div>
      </div>
    </div>
  </div>
  <script>
    window.addEventListener('load', function() {
      $(".clear-search-holder").hide()
      $(".search-what-cont").hide()
      $("#search").click(function(e) {
        $(".search-what-text").text($("#search-input").val());
        $(".search-what-cont").show();
        $(".result").each(function(e) {
          var text = $(this).text().toLowerCase();
          if (text.indexOf($("#search-input").val().toLowerCase()) > -1) {
            $(this).show();
          } else {
            $(this).hide();
          }
        });
      });
      $("#clear-search, .search-what-close").click(function(e) {
        $(".clear-search-holder").show()
        $(".search-what-text").text($("#search-input").val());
        $(".search-what-cont").show()
        clear - search - holder
        $(".search-what-cont").hide();
        $("#search-input").val("");
        $(".result").each(function(e) {
          $(this).show();
        });
        $(this).blur();
      });
    });
  </script>
  <script type="text/javascript">
    window.addEventListener('load', function() {
      var count = $('.govuk-table__row').length - 1
      // show hide content
      $('.derfa-filter--content').hide()
      $('.defra-filter--action').show()
      $('#js-case-count').text(count);
      if (count == 0) {
        $('.govuk-table').hide()
      }
      $('.derfa-filter--content').hide()
      $('#defra-filter--button').on("click", function() {
        if (!$('.defra-filter--action').hasClass('defra-filter--open')) {
          $('.derfa-filter--content').show().focus()
          $('.defra-filter--action').addClass('defra-filter--open')
          $('#defra-filter--button').attr('aria-expanded', 'true');
          $(".defra-filter--button-content").text('Hide filters')

        } else {
          $('.derfa-filter--content').hide()
          $('.defra-filter--action').removeClass('defra-filter--open')
          $('#defra-filter--button').attr('aria-expanded', 'false');
          $(".defra-filter--button-content").text('Show filters')
        }
      })
    })
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function(event) {
      if (document.querySelectorAll('.sm-daterange-component').length) {
        SmDateRangePicker('#from', '#to').init();
      }
    });
  </script>
  {% endblock %}
